<Window x:Class="MusicEngineEditor.Views.VstPluginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="VST Plugin"
        Width="800" Height="600"
        MinWidth="400" MinHeight="300"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        Foreground="{DynamicResource ForegroundBrush}"
        ShowInTaskbar="True"
        ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <!-- Bypass indicator colors -->
        <SolidColorBrush x:Key="BypassOverlayBrush" Color="#AA1E1F22"/>
        <SolidColorBrush x:Key="BypassTextBrush" Color="#E89C4B"/>
        <SolidColorBrush x:Key="BypassBorderBrush" Color="#E89C4B"/>
        <SolidColorBrush x:Key="BypassButtonActiveBrush" Color="#E89C4B"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with plugin info -->
        <Border Grid.Row="0" Background="{DynamicResource HeaderBackgroundBrush}"
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1"
                Padding="12,8">
            <DockPanel>
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button x:Name="MinimizeButton" Content="&#x2212;"
                            Style="{DynamicResource IconButtonStyle}"
                            Click="MinimizeButton_Click"
                            ToolTip="Minimize to taskbar"
                            Width="28" Height="28" Margin="4,0"/>
                    <Button x:Name="CloseButton" Content="&#x2715;"
                            Style="{DynamicResource IconButtonStyle}"
                            Click="CloseButton_Click"
                            ToolTip="Close window (plugin keeps running)"
                            Width="28" Height="28"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="PluginNameText" Text="Plugin Name"
                               FontWeight="SemiBold" FontSize="14"
                               VerticalAlignment="Center"/>
                    <TextBlock x:Name="PluginTypeText" Text="(VST3)"
                               Foreground="{DynamicResource SecondaryForegroundBrush}"
                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                    <TextBlock x:Name="PresetNameText" Text=""
                               Foreground="{DynamicResource SecondaryForegroundBrush}"
                               VerticalAlignment="Center" Margin="8,0,0,0"
                               FontStyle="Italic"/>
                    <!-- Bypass indicator in header -->
                    <Border x:Name="HeaderBypassBadge"
                            Background="{StaticResource BypassButtonActiveBrush}"
                            CornerRadius="3"
                            Padding="6,2"
                            Margin="10,0,0,0"
                            Visibility="Collapsed">
                        <TextBlock Text="BYPASSED"
                                   FontSize="10"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                    </Border>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Plugin host area - this is where the VST UI will be embedded -->
        <Border Grid.Row="1" x:Name="PluginHostBorder" Background="{DynamicResource EditorBackgroundBrush}">
            <Grid x:Name="PluginHostContainer">
                <!-- Placeholder when no plugin UI is available -->
                <StackPanel x:Name="PlaceholderPanel"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center">
                    <TextBlock Text="VST Plugin" FontSize="24"
                               Foreground="{DynamicResource SecondaryForegroundBrush}"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="PluginStatusText" Text="Plugin UI loading..."
                               Foreground="{DynamicResource SecondaryForegroundBrush}"
                               HorizontalAlignment="Center" Margin="0,8,0,0"/>
                </StackPanel>

                <!-- WindowsFormsHost for hosting native VST windows -->
                <WindowsFormsHost x:Name="VstHost" Visibility="Collapsed"/>

                <!-- Bypass overlay - shown when plugin is bypassed -->
                <Border x:Name="BypassOverlay"
                        Background="{StaticResource BypassOverlayBrush}"
                        Visibility="Collapsed">
                    <Border BorderBrush="{StaticResource BypassBorderBrush}"
                            BorderThickness="3"
                            CornerRadius="8"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Padding="40,25">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="BYPASS"
                                       FontSize="36"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource BypassTextBrush}"
                                       HorizontalAlignment="Center">
                                <TextBlock.Effect>
                                    <DropShadowEffect Color="#000000" BlurRadius="8" ShadowDepth="0" Opacity="0.5"/>
                                </TextBlock.Effect>
                            </TextBlock>
                            <TextBlock Text="Plugin processing disabled"
                                       FontSize="12"
                                       Foreground="{DynamicResource SecondaryForegroundBrush}"
                                       HorizontalAlignment="Center"
                                       Margin="0,8,0,0"/>
                        </StackPanel>
                    </Border>
                </Border>
            </Grid>
        </Border>

        <!-- Footer with controls -->
        <Border Grid.Row="2" Background="{DynamicResource ToolbarBackgroundBrush}"
                BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0"
                Padding="12,6">
            <DockPanel>
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <!-- Bypass button with toggle styling -->
                    <Border x:Name="BypassButtonBorder"
                            Background="Transparent"
                            BorderBrush="{DynamicResource SubtleBorderBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Margin="0,0,8,0">
                        <Button x:Name="BypassButton"
                                Content="Bypass"
                                Click="BypassButton_Click"
                                Background="Transparent"
                                Foreground="{DynamicResource ForegroundBrush}"
                                BorderThickness="0"
                                Padding="12,6"
                                Cursor="Hand"
                                ToolTip="Toggle plugin bypass (pass audio through without processing)"/>
                    </Border>
                    <Button Content="Presets" Style="{DynamicResource ToolbarButtonStyle}"
                            x:Name="PresetsButton" Click="PresetsButton_Click"
                            ToolTip="Browse and manage presets"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Variable:" Foreground="{DynamicResource SecondaryForegroundBrush}"
                               VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <TextBlock x:Name="VariableNameText" Text="synth"
                               Foreground="{DynamicResource ForegroundBrush}"
                               FontFamily="JetBrains Mono, Consolas"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </DockPanel>
        </Border>
    </Grid>
</Window>
