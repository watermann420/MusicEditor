<UserControl x:Class="MusicEngineEditor.Controls.CollaboratorCursor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="40" d:DesignWidth="100"
             IsHitTestVisible="False">

    <UserControl.Resources>
        <!-- Drop shadow for cursor -->
        <DropShadowEffect x:Key="CursorShadow"
                          BlurRadius="4"
                          ShadowDepth="1"
                          Direction="315"
                          Color="Black"
                          Opacity="0.4"/>

        <!-- Animation for cursor fade-in -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="0" To="1"
                             Duration="0:0:0.15"/>
        </Storyboard>

        <!-- Animation for cursor pulse (when actively editing) -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="CursorTriangle"
                             Storyboard.TargetProperty="Opacity"
                             From="1" To="0.6"
                             Duration="0:0:0.5"
                             AutoReverse="True"/>
        </Storyboard>
    </UserControl.Resources>

    <Canvas x:Name="CursorCanvas">
        <!-- Cursor Triangle/Arrow pointing down-right -->
        <Polygon x:Name="CursorTriangle"
                 Points="0,0 12,10 5,10 5,18 0,18"
                 Canvas.Left="0"
                 Canvas.Top="0"
                 Effect="{StaticResource CursorShadow}">
            <Polygon.Fill>
                <SolidColorBrush x:Name="CursorFill" Color="#00D9FF"/>
            </Polygon.Fill>
            <Polygon.Stroke>
                <SolidColorBrush Color="White"/>
            </Polygon.Stroke>
            <Polygon.StrokeThickness>1</Polygon.StrokeThickness>
        </Polygon>

        <!-- Name Label -->
        <Border x:Name="NameBorder"
                Canvas.Left="14"
                Canvas.Top="0"
                CornerRadius="3"
                Padding="6,2"
                Effect="{StaticResource CursorShadow}">
            <Border.Background>
                <SolidColorBrush x:Name="NameBackground" Color="#00D9FF"/>
            </Border.Background>
            <TextBlock x:Name="NameText"
                       Text="Collaborator"
                       FontSize="11"
                       FontWeight="SemiBold"
                       Foreground="White"
                       TextTrimming="CharacterEllipsis"
                       MaxWidth="120"/>
        </Border>

        <!-- Selection Rectangle (shown when peer has a selection) -->
        <Rectangle x:Name="SelectionRect"
                   Canvas.Left="0"
                   Canvas.Top="20"
                   Width="100"
                   Height="50"
                   Visibility="Collapsed"
                   StrokeThickness="2"
                   StrokeDashArray="4,2"
                   RadiusX="2"
                   RadiusY="2">
            <Rectangle.Fill>
                <SolidColorBrush x:Name="SelectionFill" Color="#00D9FF" Opacity="0.15"/>
            </Rectangle.Fill>
            <Rectangle.Stroke>
                <SolidColorBrush x:Name="SelectionStroke" Color="#00D9FF"/>
            </Rectangle.Stroke>
        </Rectangle>
    </Canvas>
</UserControl>
